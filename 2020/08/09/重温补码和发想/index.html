<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>重温补码和发想 | IlluminatedWorm&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="正负和原码之难  在计算机中区分正负数有许多好处，此时可以只考虑一个，不用特别设计和实现减法，将减法转换为加法即可：$$5-3&#x3D;5+(-3)$$  下表展示了3位数中的应用实例。    十进制表示 原码 补码    0 000 000   1 001 001   2 010 010   3 011 011   -4 N&#x2F;A***** 100   -3 111 101   -2 110 110">
<meta property="og:type" content="article">
<meta property="og:title" content="重温补码和发想">
<meta property="og:url" content="http://yoursite.com/2020/08/09/%E9%87%8D%E6%B8%A9%E8%A1%A5%E7%A0%81%E5%92%8C%E5%8F%91%E6%83%B3/index.html">
<meta property="og:site_name" content="IlluminatedWorm&#39;s Blog">
<meta property="og:description" content="正负和原码之难  在计算机中区分正负数有许多好处，此时可以只考虑一个，不用特别设计和实现减法，将减法转换为加法即可：$$5-3&#x3D;5+(-3)$$  下表展示了3位数中的应用实例。    十进制表示 原码 补码    0 000 000   1 001 001   2 010 010   3 011 011   -4 N&#x2F;A***** 100   -3 111 101   -2 110 110">
<meta property="article:published_time" content="2020-08-09T06:27:04.000Z">
<meta property="article:modified_time" content="2020-08-09T10:23:54.800Z">
<meta property="article:author" content="IlluminatedWorm">
<meta property="article:tag" content="数学">
<meta name="twitter:card" content="summary">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 4.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">IlluminatedWorm&#39;s Blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-重温补码和发想" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/08/09/%E9%87%8D%E6%B8%A9%E8%A1%A5%E7%A0%81%E5%92%8C%E5%8F%91%E6%83%B3/" class="article-date">
  <time datetime="2020-08-09T06:27:04.000Z" itemprop="datePublished">2020-08-09</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      重温补码和发想
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="正负和原码之难"><a href="#正负和原码之难" class="headerlink" title="正负和原码之难"></a>正负和原码之难</h2><p>  在计算机中区分正负数有许多好处，此时可以只考虑一个，不用特别设计和实现减法，将减法转换为加法即可：<br>$$<br>5-3=5+(-3)<br>$$<br>  下表展示了3位数中的应用实例。</p>
<table>
<thead>
<tr>
<th align="center">十进制表示</th>
<th align="center">原码</th>
<th align="center">补码</th>
</tr>
</thead>
<tbody><tr>
<td align="center">0</td>
<td align="center">000</td>
<td align="center">000</td>
</tr>
<tr>
<td align="center">1</td>
<td align="center">001</td>
<td align="center">001</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">010</td>
<td align="center">010</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">011</td>
<td align="center">011</td>
</tr>
<tr>
<td align="center">-4</td>
<td align="center">N/A*****</td>
<td align="center">100</td>
</tr>
<tr>
<td align="center">-3</td>
<td align="center">111</td>
<td align="center">101</td>
</tr>
<tr>
<td align="center">-2</td>
<td align="center">110</td>
<td align="center">110</td>
</tr>
<tr>
<td align="center">-1</td>
<td align="center">101</td>
<td align="center">111</td>
</tr>
</tbody></table>
<p>  就像为了标明数的正负而在开头添加＋或－一样，用二进制数的第一位表示正负和剩余位数表示值是理所当然的做法。原码第一位作为符号位，0表示负，1则表示正，剩余位数就是原数绝对值的二进制表示。</p>
<p>  数被表示好了，并且能区分正负，接下来当然要进行运算，那么问题出现了：<br>$$<br>3+(-3)=0\neq010=011+111<br>$$<br>  那么该将如何呢？让计算机去根据符号位进行判断大概是最直观的解决，这当然没错。然而需要注意的是，加法在计算机中已经是非常基础的运算，它理应尽可能地简单，否则将严重拖累计算机的性能，之前提到的把减法视作加法也基于这样的原则。带上新条件重新思考，那么摆在脚下的路仍然是让符号位也参与加法运算，所以原码这样的方法是行不通了。</p>
<h2 id="冯·诺依曼小剧场"><a href="#冯·诺依曼小剧场" class="headerlink" title="冯·诺依曼小剧场"></a>冯·诺依曼小剧场</h2><p>  首先重新看回上面的原码运算，<strong>请特别注意在有限的3位数中011+111的结果并不是1010，计算机“丢弃”了超越的进位！进位而位不足便添位在人的认识中是非常自然的，但对于计算机并非如此。这个容易略过的事实十分重要。</strong></p>
<hr>
<p>  现在请考虑：你是一个认得0~9的十进制思想的人，你只能做加法，你有且只有一位数，不得添也不得去，9+1的结果对于你来说是多少？暂时跳出这个奇怪的身份，当然会知道9+1=10，但此时的你并不能添位，因此10里的1就这么“溢出”了，你丢掉了这个数字，以仅剩下的0作为结果。在有限位数的计算中，一直持续加下去，并不会得到＋∞，而是在有限位数的有限表示中循环：0, 1, 2… 8, 9, 0, 1, 2…</p>
<p>  请再考虑：虽然你只能做加法，却有人需要你做减法，现在轮到这位强人所难的家伙头疼了，他知道不能让你进行8-3这样的运算，既然只能做加法那就做加法，那么8加上什么数才可以呢。他也想起了上面提到的循环，于是他知道了，让你计算8+7的结果便能得到和8-3相同的结果。他决定做一张对照表，把某些类似+7和-3这样成对关联的数对应起来，方便查询。依样画葫芦，他得到了这样一张表：</p>
<table>
<thead>
<tr>
<th>他：</th>
<th>0</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>-5</th>
<th>-4</th>
<th>-3</th>
<th>-2</th>
<th>-1</th>
</tr>
</thead>
<tbody><tr>
<td>你：</td>
<td>0</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
<td>8</td>
<td>9</td>
</tr>
</tbody></table>
<p>  他进一步想到，万一你以后可以支持更多位和更多表示了呢，又重新来一遍不成？要找出这种映射的规律，细细一看，并不难发现：</p>
<p>  -5+10=5，-4+6=10，-3+10=7……</p>
<p>  原来如此，原值和映射值之和等于10。为什么是10呢，他稍微对更高表示量的情况作了验证，确实这个和就是适逢进位溢出的那个数。</p>
<h2 id="补码，重整乾坤"><a href="#补码，重整乾坤" class="headerlink" title="补码，重整乾坤"></a>补码，重整乾坤</h2><p>  补码，就是一种在计算机中用二进制数表示有正负符号的数的方法。用这种方法处理整数时，正数的补码为其原码，而负数的补码与原码之和为2<sup>N</sup>。 对于二进制数，N位数适逢进位溢出的数就是2<sup>N</sup>。</p>
<p>  约翰·冯·诺依曼当然不会组织这样的小剧场，他倒确实是补码的提案者，而补码的用意就和小剧场里的映射表一样，要将一系列循环表示的前半部分当作正数，后半部分当作负数，这样便同时解决了表示正负，以加代减和令加法简单这整整三个问题。</p>
<p>  你应该已经注意到在第一张表格中，-4只有对应的补码，而原码不适用。这样写当然是不对的。不经修正的原码有这样的缺陷：000和100在原码中严格地看来代表着＋0和－0，但±0对于数学和正常人来说都是没有意义的。为了满足0就是0，指定000就是0而不是什么＋0，那100又如何处置呢，不能指定它就是4，因为第一位数被用来表示正负而不是值，你会发现在原码方法有这样一个叫人万般尴尬的特殊情况——即使强行为负零指定了某个特定的值，也不会有什么额外好处。</p>
<p>  万幸的是在补码中没有这么尴尬，就当100是-4的原码，则-4的补码也是100，所以补码还处理了正负零这第四个问题（如Java中占8位的byte型表示－128<del>127而不是－127</del>127，－128~－1和0到127都有128个数），当然在真正使用原码和反码的情况里也是能解决正负零问题的，只是不如补码自洽且利于计算。</p>
<p>  看得出，原码是一种“天真简单的”映射，而补码旨在重排。你可以为它们找出很多联系来绕晕自己，甚至联系反码来进一步绕晕自己，或者把它们看成泾渭分明的三种方法——你完全不需要知道原码也可以使用补码，只需要遵照以下规则：</p>
<ol>
<li><p>使用总数为偶数的一系列循环二进制数。</p>
</li>
<li><p>将这些表示对半拆开。</p>
</li>
<li><p>前半部分依次表示0, 1, 2… N。</p>
</li>
<li><p>后半部分依次表示－(N+1), －(N), －(N-1)… -1。</p>
<p>你也可以把-3+10=7理解成-3和7对10同模，并提炼出这样的关系：<br>$$<br>j\equiv(j+k)\pmod{k}<br>$$<br>毕竟：<br>$$<br>j\mod{k}=j-k\quad (j\ge k&gt;0)<br>$$<br>表示方法和理解都是可以有很多种的。</p>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/08/09/%E9%87%8D%E6%B8%A9%E8%A1%A5%E7%A0%81%E5%92%8C%E5%8F%91%E6%83%B3/" data-id="ckdmxw9uw00000ould3ewb7lc" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6/" rel="tag">数学</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2020/07/29/%E7%94%A8%E5%8F%8D%E5%B0%84%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%9B%E7%94%A8%E6%B7%B1%E6%8B%B7%E8%B4%9D%E5%B7%A5%E5%85%B7%E7%B1%BB/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">用反射实现的泛用深拷贝工具类</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/" rel="tag">Java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6/" rel="tag">数学</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Java/" style="font-size: 20px;">Java</a> <a href="/tags/%E6%95%B0%E5%AD%A6/" style="font-size: 10px;">数学</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">February 2020</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/08/09/%E9%87%8D%E6%B8%A9%E8%A1%A5%E7%A0%81%E5%92%8C%E5%8F%91%E6%83%B3/">重温补码和发想</a>
          </li>
        
          <li>
            <a href="/2020/07/29/%E7%94%A8%E5%8F%8D%E5%B0%84%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%9B%E7%94%A8%E6%B7%B1%E6%8B%B7%E8%B4%9D%E5%B7%A5%E5%85%B7%E7%B1%BB/">用反射实现的泛用深拷贝工具类</a>
          </li>
        
          <li>
            <a href="/2020/07/21/PECS%E7%9A%84%E4%B8%80%E4%BA%9B%E8%A7%A3%E8%AF%BB/">PECS的一些解读</a>
          </li>
        
          <li>
            <a href="/2020/07/05/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%A4%84%E7%90%86%E6%96%87%E4%BB%B6%E8%B7%AF%E5%BE%84/">正则表达式处理文件路径</a>
          </li>
        
          <li>
            <a href="/2020/02/08/Java%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/">Java数据类型</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 IlluminatedWorm<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>